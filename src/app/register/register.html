<div class="register-container">
  <div class="register-card">
    <div class="card-header">
      <h3>
        <i class="fas fa-user-plus me-2"></i>
        Create Account
      </h3>
      <p>Join our Inventory Management System</p>
    </div>
    
    <div class="card-body">
      <!-- Message Display -->
      <div *ngIf="message" 
           class="alert alert-dismissible fade show" 
           [ngClass]="{
             'alert-danger': message.toLowerCase().includes('error') || 
                          message.toLowerCase().includes('failed') || 
                          message.toLowerCase().includes('exists') || 
                          message.toLowerCase().includes('required') || 
                          message.toLowerCase().includes('match') || 
                          message.toLowerCase().includes('characters'),
             'alert-success': message.toLowerCase().includes('success') || 
                            message.toLowerCase().includes('registration') || 
                            message.toLowerCase().includes('redirecting'),
             'alert-info': !(message.toLowerCase().includes('error') || 
                           message.toLowerCase().includes('failed') || 
                           message.toLowerCase().includes('exists') || 
                           message.toLowerCase().includes('required') || 
                           message.toLowerCase().includes('match') || 
                           message.toLowerCase().includes('characters') ||
                           message.toLowerCase().includes('success') || 
                           message.toLowerCase().includes('registration') || 
                           message.toLowerCase().includes('redirecting'))
           }" 
           role="alert">
        <div class="d-flex align-items-center">
          <i class="fas fa-exclamation-circle me-2" *ngIf="message.toLowerCase().includes('error') || 
                                                       message.toLowerCase().includes('failed') || 
                                                       message.toLowerCase().includes('exists') || 
                                                       message.toLowerCase().includes('required') || 
                                                       message.toLowerCase().includes('match') || 
                                                       message.toLowerCase().includes('characters')"></i>
          <i class="fas fa-check-circle me-2" *ngIf="message.toLowerCase().includes('success') || 
                                                  message.toLowerCase().includes('registration') || 
                                                  message.toLowerCase().includes('redirecting')"></i>
          <i class="fas fa-info-circle me-2" *ngIf="!(message.toLowerCase().includes('error') || 
                                                 message.toLowerCase().includes('failed') || 
                                                 message.toLowerCase().includes('exists') || 
                                                 message.toLowerCase().includes('required') || 
                                                 message.toLowerCase().includes('match') || 
                                                 message.toLowerCase().includes('characters') ||
                                                 message.toLowerCase().includes('success') || 
                                                 message.toLowerCase().includes('registration') || 
                                                 message.toLowerCase().includes('redirecting'))"></i>
          <span>{{ message }}</span>
        </div>
        <button type="button" class="btn-close" (click)="clearMessage()" aria-label="Close"></button>
      </div>

      <!-- Registration Form -->
      <form (ngSubmit)="register()" #registerForm="ngForm" class="needs-validation" novalidate>
        <div class="form-group">
          <label for="username" class="form-label">
            <i class="fas fa-user"></i>
            Username
          </label>
          <div class="input-group">
            <span class="input-group-text">
              <i class="fas fa-user"></i>
            </span>
            <input type="text" 
                   class="form-control form-control-lg" 
                   id="username" 
                   [(ngModel)]="user.username" 
                   name="username" 
                   required 
                   minlength="3"
                   placeholder="Choose a username"
                   [disabled]="isLoading"
                   autocomplete="username"
                   autofocus>
          </div>
          <div class="form-text">
            <i class="fas fa-info-circle"></i> Must be at least 3 characters
          </div>
        </div>

        <div class="form-group">
          <div class="d-flex justify-content-between">
            <label for="password" class="form-label">
              <i class="fas fa-lock"></i>
              Password
            </label>
          </div>
          <div class="input-group">
            <span class="input-group-text">
              <i class="fas fa-lock"></i>
            </span>
            <input [type]="showPassword ? 'text' : 'password'" 
                   class="form-control form-control-lg" 
                   id="password" 
                   [(ngModel)]="user.password" 
                   name="password" 
                   required 
                   minlength="6"
                   placeholder="Create a password"
                   [disabled]="isLoading"
                   (input)="checkPasswordStrength()"
                   autocomplete="new-password">
            <button type="button" 
                    class="btn btn-outline-secondary" 
                    (click)="togglePasswordVisibility()"
                    [disabled]="isLoading"
                    [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'">
              <i [class]="showPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
            </button>
          </div>
          <div class="form-text">
            <i class="fas fa-info-circle"></i> Must be at least 6 characters
          </div>
          <div class="password-strength mt-2">
            <div class="strength-bar" [ngClass]="{
              'strength-weak': passwordStrength === 'weak',
              'strength-medium': passwordStrength === 'medium',
              'strength-strong': passwordStrength === 'strong'
            }"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword" class="form-label">
            <i class="fas fa-lock"></i>
            Confirm Password
          </label>
          <div class="input-group">
            <span class="input-group-text">
              <i class="fas fa-lock"></i>
            </span>
            <input [type]="showConfirmPassword ? 'text' : 'password'" 
                   class="form-control form-control-lg" 
                   id="confirmPassword" 
                   [(ngModel)]="confirmPassword" 
                   name="confirmPassword" 
                   required 
                   placeholder="Confirm your password"
                   [disabled]="isLoading"
                   autocomplete="new-password">
            <button type="button" 
                    class="btn btn-outline-secondary" 
                    (click)="toggleConfirmPasswordVisibility()"
                    [disabled]="isLoading"
                    [attr.aria-label]="showConfirmPassword ? 'Hide password' : 'Show password'">
              <i [class]="showConfirmPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
            </button>
          </div>
        </div>

        <div class="form-group mb-4">
          <label for="role" class="form-label">
            <i class="fas fa-user-tag"></i>
            Select Role
          </label>
          <div class="input-group">
            <span class="input-group-text">
              <i class="fas fa-user-shield"></i>
            </span>
            <select class="form-select form-select-lg" 
                    id="role" 
                    [(ngModel)]="user.role" 
                    name="role"
                    [disabled]="isLoading">
              <option value="USER">User</option>
              <option value="ADMIN">Admin</option>
              <option value="MANAGER">Manager</option>
            </select>
          </div>
        </div>

        <div class="d-grid gap-2 mb-4">
          <button type="submit" 
                  class="btn btn-register" 
                  [disabled]="registerForm.form.invalid || isLoading"
                  [ngClass]="{'loading': isLoading}">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
            <span *ngIf="!isLoading">
              <i class="fas fa-user-plus me-2"></i>
            </span>
            {{ isLoading ? 'Creating Account...' : 'Create Account' }}
          </button>
        </div>

        <div class="text-center">
          <p class="text-muted mb-2">Already have an account?</p>
          <button type="button" 
                  class="btn btn-outline-success" 
                  (click)="navigateToLogin()"
                  [disabled]="isLoading">
            <i class="fas fa-sign-in-alt me-2"></i>
            Sign In
          </button>
        </div>
      </form>
    </div>
    
    <div class="card-footer bg-light text-center py-3">
      <small class="text-muted">
        <i class="fas fa-shield-alt me-1"></i>
        Secure & Encrypted Connection
      </small>
    </div>
  </div>
  
  <div class="text-center mt-4 position-absolute bottom-0 start-0 end-0 mb-3">
    <small class="text-muted">
      &copy; {{ currentYear }} Inventory Management System. All rights reserved.
    </small>
  </div>
</div>